<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Lattice PCIeDMA Device Driver : lscdma.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>lscdma.h</h1><a href="lscdma_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00003 <span class="preprocessor">#ifndef LSC_LSCDMA_H</span>
00004 <span class="preprocessor"></span><span class="preprocessor">#define LSC_LSCDMA_H</span>
00005 <span class="preprocessor"></span>
00006 <span class="preprocessor">#include &lt;linux/init.h&gt;</span>
00007 <span class="preprocessor">#include &lt;linux/module.h&gt;</span>
00008 <span class="preprocessor">#include &lt;linux/version.h&gt;</span>
00009 <span class="preprocessor">#include &lt;linux/kernel.h&gt;</span>
00010 
00011 <span class="preprocessor">#include &lt;linux/fs.h&gt;</span>
00012 <span class="preprocessor">#include &lt;linux/errno.h&gt;</span>
00013 <span class="preprocessor">#include &lt;linux/miscdevice.h&gt;</span>
00014 <span class="preprocessor">#include &lt;linux/major.h&gt;</span>
00015 <span class="preprocessor">#include &lt;linux/slab.h&gt;</span>
00016 <span class="preprocessor">#include &lt;linux/proc_fs.h&gt;</span>
00017 <span class="preprocessor">#include &lt;linux/stat.h&gt;</span>
00018 <span class="preprocessor">#include &lt;linux/init.h&gt;</span>
00019 <span class="preprocessor">#include &lt;linux/delay.h&gt;</span>
00020 
00021 <span class="preprocessor">#include &lt;linux/tty.h&gt;</span>
00022 <span class="preprocessor">#include &lt;linux/selection.h&gt;</span>
00023 <span class="preprocessor">#include &lt;linux/kmod.h&gt;</span>
00024 
00025 <span class="comment">/* For devices that use/implement shared memory (mmap) */</span>
00026 <span class="preprocessor">#include &lt;linux/mm.h&gt;</span>
00027 <span class="preprocessor">#include &lt;linux/vmalloc.h&gt;</span>
00028 <span class="preprocessor">#include &lt;linux/pagemap.h&gt;</span>
00029 <span class="preprocessor">#include &lt;linux/pci.h&gt;</span>
00030 <span class="preprocessor">#include &lt;linux/mman.h&gt;</span>
00031 
00032 <span class="preprocessor">#include &lt;linux/ioport.h&gt;</span>
00033 <span class="preprocessor">#include &lt;linux/interrupt.h&gt;</span>
00034 <span class="preprocessor">#include &lt;linux/wait.h&gt;</span>
00035 
00036 <span class="preprocessor">#include &lt;asm/uaccess.h&gt;</span>
00037 <span class="preprocessor">#include &lt;asm/io.h&gt;</span>
00038 <span class="preprocessor">#include &lt;asm/pgalloc.h&gt;</span>
00039 
00040 <span class="preprocessor">#include "<a class="code" href="_ioctl_8h.html">Ioctl.h</a>"</span>
00041 <span class="preprocessor">#include "<a class="code" href="_devices_8h.html">Devices.h</a>"</span>
00042 <span class="preprocessor">#include "<a class="code" href="_g_p_i_o_8h.html">GPIO.h</a>"</span>
00043 <span class="preprocessor">#include "<a class="code" href="_s_g_d_m_a_8h.html">SGDMA.h</a>"</span>
00044 
00045 
00046 
00047 
00048 <span class="comment">// Some Useful defines</span>
00049 <span class="preprocessor">#ifndef TRUE</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define TRUE 1</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00052 <span class="preprocessor"></span><span class="preprocessor">#ifndef FALSE</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#define FALSE 0</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#ifndef OK</span>
00056 <span class="preprocessor"></span><span class="preprocessor">#define OK 0</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00058 <span class="preprocessor"></span><span class="preprocessor">#ifndef ERROR</span>
00059 <span class="preprocessor"></span><span class="preprocessor">#define ERROR -1</span>
00060 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00061 <span class="preprocessor"></span><span class="preprocessor">#ifndef WAITING</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#define WAITING -2</span>
00063 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00064 <span class="preprocessor"></span>
00065 <span class="comment">/* Change these defines to increase number of boards supported by the driver */</span>
00066 
00067 <span class="preprocessor">#define NUM_BARS MAX_PCI_BARS  </span><span class="comment">/* defined in Ioctl.h */</span>
00068 <span class="preprocessor">#define NUM_BOARDS 4          // 4 PCIe boards per system is a lot of PCIe slots and eval boards to have on hand</span>
00069 <span class="preprocessor"></span><span class="preprocessor">#define MAX_BOARDS (NUM_BOARDS) </span>
00070 <span class="preprocessor"></span><span class="preprocessor">#define MINORS_PER_BOARD 4     // 3 minor number per discrete device</span>
00071 <span class="preprocessor"></span><span class="preprocessor">#define MAX_MINORS (MAX_BOARDS * MINORS_PER_BOARD)  </span>
00072 <span class="preprocessor"></span>
00073 
00074 <span class="preprocessor">#define DMA_BUFFER_SIZE (64 * 1024)</span>
00075 <span class="preprocessor"></span>
00076 
00077 <span class="comment">// Note: used as indexes into lists of strings</span>
00078 <span class="preprocessor">#define SC_BOARD    1</span>
00079 <span class="preprocessor"></span><span class="preprocessor">#define ECP2M_BOARD 2</span>
00080 <span class="preprocessor"></span><span class="preprocessor">#define DMA_DEMO  1</span>
00081 <span class="preprocessor"></span>
00082 <span class="comment">// NOTE: these assume the first minor number is always 0, which is probably safe ;-)</span>
00083 <span class="preprocessor">#define  LSCDMA_MINOR_TO_BOARD(a)     (a / MINORS_PER_BOARD)</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#define  LSCDMA_MINOR_TO_FUNCTION(a)  (a &amp; (MINORS_PER_BOARD - 1))</span>
00085 <span class="preprocessor"></span>
00086 
00087 <span class="comment">// The minor number tells which function of the device to open</span>
00088 <span class="preprocessor">#define MEM_ACCESS_NUM 0</span>
00089 <span class="preprocessor"></span><span class="preprocessor">#define COLOR_BARS_NUM 1</span>
00090 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_MOVE_NUM 2</span>
00091 <span class="preprocessor"></span>
00092 <span class="comment">// IP Register defines</span>
00093 <span class="preprocessor">#define STAT_CMD_REG  1</span>
00094 <span class="preprocessor"></span><span class="preprocessor">#define CAP_PTR_REG  13</span>
00095 <span class="preprocessor"></span>
00096 
00097 <span class="comment">/*-------------------------------------------------*/</span>
00098 <span class="comment">/*-------------------------------------------------*/</span>
00099 <span class="comment">/*-------------------------------------------------*/</span>
00100 <span class="comment">/*           DATA TYPES</span>
00101 <span class="comment"> */</span>
00102 <span class="comment">/*-------------------------------------------------*/</span>
00103 <span class="comment">/*-------------------------------------------------*/</span>
00104 <span class="comment">/*-------------------------------------------------*/</span>
00105 
00106 <span class="comment">// Current configuration of the SGDMA IP core</span>
00107 <span class="preprocessor">#define NUM_SGDMA_CHANNELS 2</span>
00108 <span class="preprocessor"></span><span class="preprocessor">#define DMA_WR_CHAN 0</span>
00109 <span class="preprocessor"></span><span class="preprocessor">#define DMA_RD_CHAN 1</span>
00110 <span class="preprocessor"></span>
00111 
00112 
<a name="l00118"></a><a class="code" href="struct_dev_mem_params__t.html">00118</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00119 <span class="keyword"></span>{
<a name="l00120"></a><a class="code" href="struct_dev_mem_params__t.html#o0">00120</a>         ULONG baseAddr;   
<a name="l00121"></a><a class="code" href="struct_dev_mem_params__t.html#o1">00121</a>         ULONG dataWidth;  
<a name="l00122"></a><a class="code" href="struct_dev_mem_params__t.html#o2">00122</a>         ULONG addrMode;   
<a name="l00123"></a><a class="code" href="struct_dev_mem_params__t.html#o3">00123</a>         ULONG maxAddrRange;  
00124 } <a class="code" href="struct_dev_mem_params__t.html">DevMemParams_t</a>;
00125 
<a name="l00129"></a><a class="code" href="struct_d_m_a_channel__t.html">00129</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00130 <span class="keyword"></span>{
<a name="l00131"></a><a class="code" href="struct_d_m_a_channel__t.html#o0">00131</a>     <span class="keyword">struct </span>semaphore dmaMutex;   
<a name="l00133"></a><a class="code" href="struct_d_m_a_channel__t.html#o1">00133</a>         <span class="keywordtype">bool</span> doneDMA;       
<a name="l00134"></a><a class="code" href="struct_d_m_a_channel__t.html#o2">00134</a>         <span class="keywordtype">bool</span> cancelDMA;     
<a name="l00135"></a><a class="code" href="struct_d_m_a_channel__t.html#o3">00135</a>     <span class="keywordtype">bool</span> xferStatus;    
<a name="l00137"></a><a class="code" href="struct_d_m_a_channel__t.html#o4">00137</a>         ULONG elapsedTime;      
<a name="l00138"></a><a class="code" href="struct_d_m_a_channel__t.html#o5">00138</a>         ULONG totalXferSize;    
<a name="l00139"></a><a class="code" href="struct_d_m_a_channel__t.html#o6">00139</a>         ULONG xferedSoFar;      
<a name="l00140"></a><a class="code" href="struct_d_m_a_channel__t.html#o7">00140</a>         ULONG thisXferSize;      
<a name="l00141"></a><a class="code" href="struct_d_m_a_channel__t.html#o8">00141</a>         <span class="keywordtype">void</span> *bufBaseVirtualAddr;  
<a name="l00143"></a><a class="code" href="struct_d_m_a_channel__t.html#o9">00143</a>         <span class="keywordtype">bool</span> isDmaAddr64;       
<a name="l00145"></a><a class="code" href="struct_d_m_a_channel__t.html#o10">00145</a>         ULONG numBDs;    
<a name="l00146"></a><a class="code" href="struct_d_m_a_channel__t.html#o11">00146</a>         ULONG startBD;   
<a name="l00148"></a><a class="code" href="struct_d_m_a_channel__t.html#o12">00148</a>         <a class="code" href="struct_dev_mem_params__t.html">DevMemParams_t</a> DevMem;   
<a name="l00151"></a><a class="code" href="struct_d_m_a_channel__t.html#o13">00151</a>     <span class="keyword">struct </span>page **pageList;   
<a name="l00152"></a><a class="code" href="struct_d_m_a_channel__t.html#o14">00152</a>     uint32_t numPages;        
<a name="l00153"></a><a class="code" href="struct_d_m_a_channel__t.html#o15">00153</a>     <span class="keyword">struct </span>scatterlist *sgList;  
<a name="l00154"></a><a class="code" href="struct_d_m_a_channel__t.html#o16">00154</a>     uint32_t sgLen;              
<a name="l00155"></a><a class="code" href="struct_d_m_a_channel__t.html#o17">00155</a>     <span class="keywordtype">int</span> direction;           
00158 } <a class="code" href="struct_d_m_a_channel__t.html">DMAChannel_t</a>;
00159 
00160 
<a name="l00164"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html">00164</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00165 <span class="keyword"></span>{
00166 
<a name="l00167"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o0">00167</a>         <span class="keywordtype">bool</span> DmaOk;    
<a name="l00169"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o1">00169</a>         ULONG WriteBurstSize;  
<a name="l00170"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o2">00170</a>         ULONG ReadBurstSize;  
<a name="l00172"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o3">00172</a>         <span class="keywordtype">bool</span> Reading;   
<a name="l00173"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o4">00173</a>         <span class="keywordtype">bool</span> Writing;   
<a name="l00174"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o5">00174</a>         <span class="keywordtype">bool</span> ReadChanOpen;  
<a name="l00175"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o6">00175</a>         <span class="keywordtype">bool</span> WriteChanOpen; 
<a name="l00177"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o7">00177</a>         <a class="code" href="struct_d_m_a_channel__t.html">DMAChannel_t</a> Chan[NUM_SGDMA_CHANNELS];   
<a name="l00179"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o8">00179</a>     wait_queue_head_t ReadWaitQ;  
<a name="l00180"></a><a class="code" href="struct_s_g_d_m_a_operations__t.html#o9">00180</a>     wait_queue_head_t WriteWaitQ; 
00182 } <a class="code" href="struct_s_g_d_m_a_operations__t.html">SGDMAOperations_t</a>;
00183 
00184 
<a name="l00192"></a><a class="code" href="struct_c_b_d_m_a_operations__t.html">00192</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
00193 <span class="keyword"></span>{
<a name="l00194"></a><a class="code" href="struct_c_b_d_m_a_operations__t.html#o0">00194</a>     <span class="keywordtype">bool</span>        hasDMA;        
<a name="l00195"></a><a class="code" href="struct_c_b_d_m_a_operations__t.html#o1">00195</a>         <span class="keywordtype">bool</span>            isDmaAddr64;   
<a name="l00196"></a><a class="code" href="struct_c_b_d_m_a_operations__t.html#o2">00196</a>     size_t      dmaBufSize;    
<a name="l00197"></a><a class="code" href="struct_c_b_d_m_a_operations__t.html#o3">00197</a>     dma_addr_t  dmaPCIBusAddr; 
<a name="l00198"></a><a class="code" href="struct_c_b_d_m_a_operations__t.html#o4">00198</a>     <span class="keywordtype">void</span>        *dmaCPUAddr;   
00200 } <a class="code" href="struct_c_b_d_m_a_operations__t.html">CBDMAOperations_t</a>;
00201 
00202 
00203 
<a name="l00209"></a><a class="code" href="struct_p_c_i___dev___b_a_r.html">00209</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_p_c_i___dev___b_a_r.html">PCI_Dev_BAR</a>
00210 {
00211     <span class="keywordtype">int</span>          bar;
<a name="l00212"></a><a class="code" href="struct_p_c_i___dev___b_a_r.html#o1">00212</a>     <span class="keywordtype">void</span>         *pci_addr; 
<a name="l00213"></a><a class="code" href="struct_p_c_i___dev___b_a_r.html#o2">00213</a>     <span class="keywordtype">void</span>         *kvm_addr; 
00214     <span class="keywordtype">int</span>          memType;
00215     <span class="keywordtype">int</span>          dataSize;
00216     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> len;
00217     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pci_start;   <span class="comment">/* info gathered from pci_resource_*() */</span>
00218     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pci_end;
00219     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pci_flags;
00220 } <a class="code" href="struct_p_c_i___dev___b_a_r.html">pci_dev_bar_t</a>;
00221 
00222 
<a name="l00227"></a><a class="code" href="struct_p_c_i_e___board.html">00227</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_p_c_i_e___board.html">PCIE_Board</a>
00228 {
00229         <span class="comment">//========== Driver and Device Information =============</span>
<a name="l00230"></a><a class="code" href="struct_p_c_i_e___board.html#o0">00230</a>     u32     ID;            
<a name="l00231"></a><a class="code" href="struct_p_c_i_e___board.html#o1">00231</a>     u32     demoID;        
<a name="l00232"></a><a class="code" href="struct_p_c_i_e___board.html#o2">00232</a>     u32     demoType;      
<a name="l00233"></a><a class="code" href="struct_p_c_i_e___board.html#o3">00233</a>     u32     function;      
<a name="l00234"></a><a class="code" href="struct_p_c_i_e___board.html#o4">00234</a>     u32 boardType;     
<a name="l00235"></a><a class="code" href="struct_p_c_i_e___board.html#o5">00235</a>     u32     instanceNum;   
00237         <span class="comment">//========== Driver Mutex Controls =============</span>
<a name="l00238"></a><a class="code" href="struct_p_c_i_e___board.html#o6">00238</a>     atomic_t OpenToken;    
<a name="l00239"></a><a class="code" href="struct_p_c_i_e___board.html#o7">00239</a>     spinlock_t hdwAccess;  
00242         <span class="comment">//========== PCI Enumeration and Link Info =========</span>
<a name="l00243"></a><a class="code" href="struct_p_c_i_e___board.html#o8">00243</a>     u32 majorNum;      
<a name="l00244"></a><a class="code" href="struct_p_c_i_e___board.html#o9">00244</a>     u32 minorNum;      
<a name="l00245"></a><a class="code" href="struct_p_c_i_e___board.html#o10">00245</a>     u32 PCIeMaxPayloadSize;  
<a name="l00246"></a><a class="code" href="struct_p_c_i_e___board.html#o11">00246</a>     u32 PCIeMaxReadReqSize;  
<a name="l00247"></a><a class="code" href="struct_p_c_i_e___board.html#o12">00247</a>     u32 PCIeRCBSize;         
<a name="l00248"></a><a class="code" href="struct_p_c_i_e___board.html#o13">00248</a>     u32 PCIeLinkWidth;       
<a name="l00249"></a><a class="code" href="struct_p_c_i_e___board.html#o14">00249</a>     u32 PCICfgRegs[256/4];  
00253         <span class="comment">//=========== INTERRUPT INFO ===============</span>
<a name="l00254"></a><a class="code" href="struct_p_c_i_e___board.html#o15">00254</a>     <span class="keywordtype">int</span>     IRQ;           
<a name="l00255"></a><a class="code" href="struct_p_c_i_e___board.html#o16">00255</a>     <span class="keywordtype">bool</span>    msi;        
<a name="l00256"></a><a class="code" href="struct_p_c_i_e___board.html#o17">00256</a>         ULONG   InterruptCounter;   
<a name="l00257"></a><a class="code" href="struct_p_c_i_e___board.html#o18">00257</a>         <span class="keywordtype">bool</span>    InterruptsEnabled;  
<a name="l00258"></a><a class="code" href="struct_p_c_i_e___board.html#o19">00258</a>     <span class="keyword">struct </span>tasklet_struct  isrTasklet;  
00262     <span class="comment">//================ BAR Assignments =============</span>
<a name="l00263"></a><a class="code" href="struct_p_c_i_e___board.html#o20">00263</a>     <a class="code" href="struct_p_c_i___dev___b_a_r.html">pci_dev_bar_t</a> Dev_BARs[NUM_BARS];  
<a name="l00264"></a><a class="code" href="struct_p_c_i_e___board.html#o21">00264</a>     u32     numBars;       
<a name="l00265"></a><a class="code" href="struct_p_c_i_e___board.html#o22">00265</a>     u32 mmapBAR;          
<a name="l00266"></a><a class="code" href="struct_p_c_i_e___board.html#o23">00266</a>     u32 ctrlBAR;          
<a name="l00267"></a><a class="code" href="struct_p_c_i_e___board.html#o24">00267</a>     <span class="keywordtype">void</span>    *ctrlBARaddr;     
00271         <span class="comment">//========= LINUX DEVICE TYPES =============</span>
<a name="l00272"></a><a class="code" href="struct_p_c_i_e___board.html#o25">00272</a>     <span class="keyword">struct  </span>pci_dev *pPciDev;  
<a name="l00274"></a><a class="code" href="struct_p_c_i_e___board.html#o26">00274</a>     <span class="keyword">struct </span>cdev charDev; 
00277         <span class="comment">//========= SCATTER GATHER DMA INFO =============</span>
00278         <a class="code" href="struct_s_g_d_m_a_operations__t.html">SGDMAOperations_t</a> SGDMA;
00279 
00280         <span class="comment">//========= COMMON BUFFER DMA INFO =============</span>
00281         <a class="code" href="struct_c_b_d_m_a_operations__t.html">CBDMAOperations_t</a> CBDMA;
00282 
00283 
00284 
00285 } <a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a>;
00286 
00287 
00288 
<a name="l00294"></a><a class="code" href="struct_l_s_c_d_m_a.html">00294</a> <span class="keyword">struct </span><a class="code" href="struct_l_s_c_d_m_a.html">LSCDMA</a>
00295 {
00296 
00297     dev_t   drvrDevNum;      
<a name="l00298"></a><a class="code" href="struct_l_s_c_d_m_a.html#o1">00298</a>     u32     numBoards;       
<a name="l00300"></a><a class="code" href="struct_l_s_c_d_m_a.html#o2">00300</a>     u8  numSC_Basic;     
<a name="l00301"></a><a class="code" href="struct_l_s_c_d_m_a.html#o3">00301</a>     u8  numSC_SFIF;      
<a name="l00302"></a><a class="code" href="struct_l_s_c_d_m_a.html#o4">00302</a>     u8  numECP2M_Basic;      
<a name="l00303"></a><a class="code" href="struct_l_s_c_d_m_a.html#o5">00303</a>     u8  numECP2M_SFIF;      
00306 <span class="preprocessor">#if (LINUX_VERSION_CODE &gt;= KERNEL_VERSION(2,6,12))</span>
<a name="l00307"></a><a class="code" href="struct_l_s_c_d_m_a.html#o6">00307</a> <span class="preprocessor"></span>    <span class="keyword">struct </span>class *sysClass;   
00308 <span class="preprocessor">#else</span>
00309 <span class="preprocessor"></span>    <span class="keyword">struct </span>class_simple *sysClass;   
00310 <span class="preprocessor">#endif</span>
00311 <span class="preprocessor"></span>
00312 
<a name="l00313"></a><a class="code" href="struct_l_s_c_d_m_a.html#o7">00313</a>     <a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> Board[NUM_BOARDS];  
00315 };
00316 
00317 
00318 
00319 
00320 <span class="comment">/*-------------------------------------------------*/</span>
00321 <span class="comment">/*-------------------------------------------------*/</span>
00322 <span class="comment">/*-------------------------------------------------*/</span>
00323 <span class="comment">/*</span>
00324 <span class="comment"> *            FUNCTION PROTOTYPES</span>
00325 <span class="comment"> */</span>
00326 <span class="comment">/*-------------------------------------------------*/</span>
00327 <span class="comment">/*-------------------------------------------------*/</span>
00328 <span class="comment">/*-------------------------------------------------*/</span>
00329 <span class="keyword">extern</span> <span class="keywordtype">int</span> DrvrDebug;
00330 
00331 
00332 <span class="keywordtype">bool</span> <a class="code" href="lscdma_8h.html#a25">IsrEnableInterrupts</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00333 <span class="keywordtype">bool</span> <a class="code" href="lscdma_8h.html#a26">IsrDisableInterrupts</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00334 irqreturn_t <a class="code" href="lscdma_8h.html#a27">lscdma_ISR</a>(<span class="keywordtype">int</span> irq, <span class="keywordtype">void</span> *dev_id, <span class="keyword">struct</span> pt_regs *regs);
00335 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a28">lscdma_isr_tasklet</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>);
00336 
00337 
00338 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a29">StartDmaWrite</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd,
00339            <a class="code" href="struct_d_m_a_channel__t.html">DMAChannel_t</a> *pChan);
00340 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a30">StartDmaRead</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd,
00341            <a class="code" href="struct_d_m_a_channel__t.html">DMAChannel_t</a> *pChan);
00342 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a31">initDMAChan</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd,
00343         <a class="code" href="struct_d_m_a_channel__t.html">DMAChannel_t</a> *pChan,
00344         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> userAddr,
00345         size_t len,
00346         <span class="keywordtype">int</span> direction);
00347 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a32">releaseDMAChan</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd,
00348         <a class="code" href="struct_d_m_a_channel__t.html">DMAChannel_t</a> *pChan);
00349 
00350 
00351 
00352 UCHAR <a class="code" href="lscdma_8h.html#a33">rdReg8</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG offset);
00353 USHORT <a class="code" href="lscdma_8h.html#a34">rdReg16</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG offset);
00354 ULONG <a class="code" href="lscdma_8h.html#a35">rdReg32</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG offset);
00355 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a36">wrReg8</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG offset, UCHAR val);
00356 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a37">wrReg16</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG offset, USHORT val);
00357 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a38">wrReg32</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG offset, ULONG val);
00358 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a39">ReadPCIConfigRegs</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00359 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a40">ParsePCIeLinkCap</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00360 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a41">GPIO_Setup</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00361 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a42">IntrCtrl_Setup</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00362 <span class="keywordtype">int</span> <a class="code" href="lscdma_8h.html#a43">SGDMA_Init</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00363 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a44">SGDMA_Disable</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00364 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a45">SGDMA_EnableChan</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG chan, ULONG startBD);
00365 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a46">SGDMA_DisableChan</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd, ULONG chan);
00366 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a47">SGDMA_ConfigWrite</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd,
00367             ULONG chan,
00368             ULONG nBDs,
00369             <span class="keyword">struct</span> scatterlist *pSGlist,
00370             ULONG burstSize);
00371 <span class="keywordtype">void</span> <a class="code" href="lscdma_8h.html#a48">SGDMA_ConfigRead</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd,
00372             ULONG chan,
00373             ULONG nBDs,
00374             <span class="keyword">struct</span> scatterlist *pSGlist,
00375             ULONG burstSize);
00376 <span class="keywordtype">bool</span> <a class="code" href="lscdma_8h.html#a49">SGDMA_StartWriteChan</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00377 <span class="keywordtype">bool</span> <a class="code" href="lscdma_8h.html#a50">SGDMA_StartReadChan</a>(<a class="code" href="struct_p_c_i_e___board.html">pcie_board_t</a> *pBrd);
00378 
00379 
00380 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jul 16 12:05:24 2008 for Lattice PCIeDMA Device Driver  by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
