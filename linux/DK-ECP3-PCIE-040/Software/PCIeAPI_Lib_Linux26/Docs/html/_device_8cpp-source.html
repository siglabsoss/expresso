<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Lattice PCIe API Manual: Device.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000001.html">DevObjs</a></div>
<h1>Device.cpp</h1><a href="_device_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> *  COPYRIGHT (c) 2008 by Lattice Semiconductor Corporation</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * All rights reserved. All use of this software and documentation is</span>
00005 <span class="comment"> * subject to the License Agreement located in the file LICENSE.</span>
00006 <span class="comment"> */</span>
00007 
00010 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00011 
00012 <span class="preprocessor">#include "<a class="code" href="_device_8h.html">Device.h</a>"</span>
00013 
00014 
00015 <span class="keyword">using</span> <span class="keyword">namespace </span>LatticeSemi_PCIe;
00016 
<a name="l00028"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a0">00028</a> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a0">Device::Device</a>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html">RegisterAccess</a> *pReg,
00029            <span class="keyword">const</span> <span class="keywordtype">char</span> *nameStr, 
00030            uint32_t addr, 
00031            uint32_t range) 
00032 {
00033     this-&gt;pReg = pReg;
00034     this-&gt;name = nameStr;
00035     this-&gt;baseAddress = addr;
00036     this-&gt;addrLimit = range - 1;
00037     this-&gt;addrRange = range;
00038 
00039 
00040 }
00041 
00042 
<a name="l00047"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a1">00047</a> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a1">Device::~Device</a>()
00048 {
00049 }
00050 
00051 
<a name="l00056"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a2">00056</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a2">Device::getName</a>(<span class="keywordtype">void</span>)
00057 {
00058     <span class="keywordflow">return</span>(name.c_str());
00059 }
00060 
00061 
<a name="l00069"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a15">00069</a> uint32_t <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a15">Device::getRange</a>(<span class="keywordtype">void</span>) 
00070 { 
00071     <span class="keywordflow">return</span>(addrRange);
00072 }
00073 
00074 
00075 
00076 <span class="comment">/*===========================================================*/</span>
00077 <span class="comment">/*===========================================================*/</span>
00078 <span class="comment">/*           Single Access Methods                            */</span>
00079 <span class="comment">/*===========================================================*/</span>
00080 <span class="comment">/*===========================================================*/</span>
00081 
<a name="l00090"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a3">00090</a> uint8_t <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a3">Device::read8</a>(uint32_t offset)
00091 {
00092     uint8_t val;
00093      <span class="keywordflow">if</span> (offset &gt; addrLimit)
00094          <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::read8() range error!"</span>));
00095      val = pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a2">read8</a>(baseAddress + offset);
00096 
00097      <span class="keywordflow">return</span>(val);
00098 }
00099 
00100 
<a name="l00109"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a4">00109</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a4">Device::write8</a>(uint32_t offset, uint8_t val)
00110 {
00111     <span class="keywordflow">if</span> (offset &gt; addrLimit) 
00112         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::write8() range error!"</span>));
00113     pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a3">write8</a>(baseAddress + offset, val);
00114 }
00115 
00116 
<a name="l00125"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a5">00125</a> uint16_t <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a5">Device::read16</a>(uint32_t offset)
00126 {
00127     uint16_t val;
00128     <span class="keywordflow">if</span> (offset &gt; addrLimit)
00129         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::read16() range error!"</span>));
00130     val = pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a4">read16</a>(baseAddress + offset);
00131     <span class="keywordflow">return</span>(val);
00132 }
00133 
00134 
<a name="l00143"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a6">00143</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a6">Device::write16</a>(uint32_t offset, uint16_t val)
00144 {
00145     <span class="keywordflow">if</span> (offset &gt; addrLimit) 
00146         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::write16() range error!"</span>));
00147     pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a5">write16</a>(baseAddress + offset, val);
00148 }
00149 
00150 
<a name="l00159"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a7">00159</a> uint32_t <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a7">Device::read32</a>(uint32_t offset) 
00160 {
00161     uint32_t val; 
00162     <span class="keywordflow">if</span> (offset &gt; addrLimit) 
00163         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::read32() range error!"</span>));
00164     val = pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a6">read32</a>(baseAddress + offset);
00165     <span class="keywordflow">return</span>(val);
00166 }
00167 
00168 
<a name="l00177"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a8">00177</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a8">Device::write32</a>(uint32_t offset, uint32_t val)
00178 { 
00179     <span class="keywordflow">if</span> (offset &gt; addrLimit) 
00180         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::write32() range error!"</span>));
00181     pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a7">write32</a>(baseAddress + offset, val);
00182 }
00183 
00184 
00185 
00186 <span class="comment">/*===========================================================*/</span>
00187 <span class="comment">/*===========================================================*/</span>
00188 <span class="comment">/*           Block Access Methods                            */</span>
00189 <span class="comment">/*===========================================================*/</span>
00190 <span class="comment">/*===========================================================*/</span>
00191 
<a name="l00202"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a9">00202</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a3">Device::read8</a>(uint32_t offset, uint8_t *val, size_t len, <span class="keywordtype">bool</span> incAddr)
00203 {
00204      <span class="keywordflow">if</span> (offset + len &gt; addrRange) 
00205          <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_read8() range error!"</span>));
00206      <span class="keywordflow">if</span> (!(pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a2">read8</a>(baseAddress + offset, val, len, incAddr)))
00207          <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_read8() RegisterAccess error!"</span>));
00208 }
00209 
00210 
<a name="l00221"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a10">00221</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a4">Device::write8</a>(uint32_t offset, uint8_t *val, size_t len, <span class="keywordtype">bool</span> incAddr)
00222 {
00223     <span class="keywordflow">if</span> (offset + len &gt; addrRange) 
00224         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_write8() range error!"</span>));
00225     <span class="keywordflow">if</span> (!(pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a3">write8</a>(baseAddress + offset, val, len, incAddr)))
00226         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_write8() RegisterAccess error!"</span>));
00227 }
00228 
00229 
<a name="l00240"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a11">00240</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a5">Device::read16</a>(uint32_t offset, uint16_t *val, size_t len, <span class="keywordtype">bool</span> incAddr) 
00241 {
00242     <span class="keywordflow">if</span> (offset + len &gt; addrRange) 
00243         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_read16() range error!"</span>));
00244     <span class="keywordflow">if</span> (!(pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a4">read16</a>(baseAddress + offset, val, len, incAddr)))
00245         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_read16() RegisterAccess error!"</span>));
00246 }
00247 
00248 
<a name="l00259"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a12">00259</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a6">Device::write16</a>(uint32_t offset, uint16_t *val, size_t len, <span class="keywordtype">bool</span> incAddr)
00260 {
00261     <span class="keywordflow">if</span> (offset + len &gt; addrRange) 
00262         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_write16() range error!"</span>));
00263     <span class="keywordflow">if</span> (!(pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a5">write16</a>(baseAddress + offset, val, len, incAddr)))
00264         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_write16() RegisterAccess error!"</span>));
00265 }
00266 
00267 
<a name="l00278"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a13">00278</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a7">Device::read32</a>(uint32_t offset, uint32_t *val, size_t len, <span class="keywordtype">bool</span> incAddr)
00279 { 
00280     <span class="keywordflow">if</span> (offset + len &gt; addrRange) 
00281         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_read32() range error!"</span>));
00282     <span class="keywordflow">if</span> (!(pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a6">read32</a>(baseAddress + offset, val, len, incAddr)))
00283         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_read32() RegisterAccess error!"</span>));
00284 }
00285 
00286 
<a name="l00297"></a><a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a14">00297</a> <span class="keywordtype">void</span> <a class="code" href="class_lattice_semi___p_c_ie_1_1_device.html#a8">Device::write32</a>(uint32_t offset, uint32_t *val, size_t len, <span class="keywordtype">bool</span> incAddr) 
00298 { 
00299     <span class="keywordflow">if</span> (offset + len &gt; addrRange) 
00300         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_write32() range error!"</span>));
00301     <span class="keywordflow">if</span> (!(pReg-&gt;<a class="code" href="class_lattice_semi___p_c_ie_1_1_register_access.html#a7">write32</a>(baseAddress + offset, val, len, incAddr)))
00302         <span class="keywordflow">throw</span>(<a class="code" href="class_lattice_semi___p_c_ie_1_1_device_error.html">DeviceError</a>(<span class="stringliteral">"Device::block_write32() RegisterAccess error!"</span>));
00303 }
00304 
00305 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jul 16 12:05:26 2008 for Lattice PCIe API Manual by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
