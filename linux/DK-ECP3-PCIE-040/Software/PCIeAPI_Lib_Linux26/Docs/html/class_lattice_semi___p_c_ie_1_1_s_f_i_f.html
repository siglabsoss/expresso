<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Lattice PCIe API Manual: LatticeSemi_PCIe::SFIF Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>LatticeSemi_PCIe::SFIF Class Reference</h1><code>#include &lt;<a class="el" href="_s_f_i_f_8h-source.html">SFIF.h</a>&gt;</code>
<p>
<p>Inheritance diagram for LatticeSemi_PCIe::SFIF:
<p><center><img src="class_lattice_semi___p_c_ie_1_1_s_f_i_f.png" usemap="#LatticeSemi_PCIe::SFIF_map" border="0" alt=""></center>
<map name="LatticeSemi_PCIe::SFIF_map">
<area href="class_lattice_semi___p_c_ie_1_1_device.html" alt="LatticeSemi_PCIe::Device" shape="rect" coords="0,0,156,24">
</map>
<a href="class_lattice_semi___p_c_ie_1_1_s_f_i_f-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a0">SFIF</a> (const char *nameStr, uint32_t addr, <a class="el" href="class_lattice_semi___p_c_ie_1_1_register_access.html">LatticeSemi_PCIe::RegisterAccess</a> *pRA)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a1">~SFIF</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a2">showRegs</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a3">getSFIFParseRxFIFO</a> (string &amp;outs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a4">getSFIFRegs</a> (long long *elements, int len)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a5">getCntrs</a> (SFIFCntrs_t &amp;cnts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a6">getRxFIFO</a> (uint32_t *pBuf, size_t len=0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a7">cfgTLP</a> (uint32_t rlxOrd, uint32_t snoop, uint32_t trafficClass, uint32_t poisoned)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a8">setupSFIF</a> (uint32_t runMode, uint32_t trafficMode, uint32_t cycles, uint32_t ICG, uint32_t rdTLPSize, uint32_t wrTLPSize, uint32_t numRdTLPs, uint32_t numWrTLPs, uint32_t pktRdRatio=4, uint32_t pktWrRatio=1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a9">verifyMWrXfer</a> (uint32_t *pUserBuf, size_t len=0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a10">startSFIF</a> (bool loop)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a11">stopSFIF</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a12">disableSFIF</a> ()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Specific definition of a Lattice <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> IP module used in demos.<p>
This class inherits from the generic <a class="el" href="class_lattice_semi___p_c_ie_1_1_device.html">Device</a> class to provide the actual read/write methods. The class needs a <a class="el" href="class_lattice_semi___p_c_ie_1_1_register_access.html">RegisterAccess</a> object (the Driver Interface) to pass to the <a class="el" href="class_lattice_semi___p_c_ie_1_1_device.html">Device</a> class for the hardware access. <p>
The <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> module contains the following registers: <ul>
<li>
0x00 Global Control - Controls operation of <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> </li>
<li>
0x04 Tx TLP Control - Tx TLP control of loading TLP into FIFO </li>
<li>
0x08 Tx IPG Control - Tx Inter TLP Gap control </li>
<li>
0x0c Tx TLP Data - DW of TLP data </li>
<li>
0x10 Rx TLP Data - DW of Completion TLP data </li>
<li>
0x14 Elapsed Count - Number of clock cycles in current run </li>
<li>
0x18 Tx TLP Count - Number of Tx TLPs sent in current run </li>
<li>
0x1c Rx TLP Count - Number of CplDs received in current run </li>
<li>
0x20 Wr Wait Time - Number of clock cycles waiting for Posted Credits in current run </li>
<li>
0x24 Last CplD Time - Timestamp for last CplD </li>
<li>
0x28 Rd Wait Time - Number of clocks cycles waiting for Non-Posted Credits or Tags in current run </li>
</ul>

<p>

<p>
Definition at line <a class="el" href="_s_f_i_f_8h-source.html#l00093">93</a> of file <a class="el" href="_s_f_i_f_8h-source.html">SFIF.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="LatticeSemi_PCIe::SFIF::SFIF"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">SFIF::SFIF           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>nameStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>baseAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="class_lattice_semi___p_c_ie_1_1_register_access.html">LatticeSemi_PCIe::RegisterAccess</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pRA</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Construct access to a Lattice Demo <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> IP module. Register access to the IP in the FPGA device is through the Driver Interface object instantiated to access the real hardware and do reads/writes.<p>
The base class <a class="el" href="class_lattice_semi___p_c_ie_1_1_device.html">Device</a> is initialized to the base address and register size.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nameStr</em>&nbsp;</td><td>the name of the FPGA device for unique naming </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>baseAddr</em>&nbsp;</td><td>the physical bus address the device registers start at </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pRA</em>&nbsp;</td><td>pointer to the LSCPCIe2 driver (which is a <a class="el" href="class_lattice_semi___p_c_ie_1_1_register_access.html">RegisterAccess</a> object) for accessing the hardware and for obtaining info about Common Buffer memory addresses, sizes and clearing &amp; checking memory after thruput tests. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00063">63</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="lscpcie2_2_ioctl_8h-source.html#l00037">ExtraResourceInfo_t::busNum</a>, <a class="el" href="lscpcie2_2_ioctl_8h-source.html#l00038">ExtraResourceInfo_t::deviceNum</a>, <a class="el" href="lscpcie2_2_ioctl_8h-source.html#l00044">ExtraResourceInfo_t::DmaBufSize</a>, <a class="el" href="lscpcie2_2_ioctl_8h-source.html#l00047">ExtraResourceInfo_t::DmaPhyAddrLo</a>, <a class="el" href="lscpcie2_2_ioctl_8h-source.html#l00039">ExtraResourceInfo_t::functionNum</a>, and <a class="el" href="_l_s_c_p_c_ie2___i_f_8cpp-source.html#l00065">LatticeSemi_PCIe::LSCPCIe2_IF::getPciDriverExtraInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="LatticeSemi_PCIe::SFIF::~SFIF"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">SFIF::~<a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destroy the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> IP module. The device should no longer be accessed using any methods. All references to the device will now be invalid. 
<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00133">133</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a7" doxytag="LatticeSemi_PCIe::SFIF::cfgTLP"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SFIF::cfgTLP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>rlxOrd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>snoop</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>trafficClass</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>poisoned</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set specific global parameters for the all TLP headers that are generated. See the PCIe spec for details on each field. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rlxOrd</em>&nbsp;</td><td>the Relaxed Order bit setting </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>snoop</em>&nbsp;</td><td>the Cache Snoop bit setting </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>trafficClass</em>&nbsp;</td><td>the trafficClass bit setting </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>poisoned</em>&nbsp;</td><td>the Poisoned bit setting </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true if bits are legal values and set </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00241">241</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="LatticeSemi_PCIe::SFIF::disableSFIF"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void SFIF::disableSFIF           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Disable the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> by clearing all bits in control register. Called when exiting to ensure <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> is no longer running and DMAing into memory. 
<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00223">223</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00177">LatticeSemi_PCIe::Device::write32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="LatticeSemi_PCIe::SFIF::getCntrs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void SFIF::getCntrs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SFIFCntrs_t &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cnts</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the various counter register values in the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> in a structure. This doesn't read all the reigsters, just the ones useful for computing throughput and time spent waiting credits. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>cnts</em>&nbsp;</td><td>the user supplied structure to return the register values in </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00288">288</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="LatticeSemi_PCIe::SFIF::getRxFIFO"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">uint32_t SFIF::getRxFIFO           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint32_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>pBuf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the contents of the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> Rx FIFO. Read the RX FIFO register until the FIFO is empty. The max size is 16 KB dictated by the current IP design. Less than 16KB may be read, even 0 bytes if the FIFO is already empty. The raw DWORD contents are returned. No processing is done on the contents. The format of the data contents: <br>
 [time_stamp:1DW][time_stamp:1DW][TLP_header:3DW][TLP_payload:nDW]... <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pBuf</em>&nbsp;</td><td>where to store the data read. Must be atleast FIFO_SIZE. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>number of bytes to read (must be on word boundaries) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of bytes read from the FIFO. </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00312">312</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="LatticeSemi_PCIe::SFIF::getSFIFParseRxFIFO"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SFIF::getSFIFParseRxFIFO           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">string &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>outs</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Examine the contents of the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> RX FIFO and parse into recvs CplD TLPs that correspond to the MRd requests. The TLP contents are formatted and returned in a string for display. If the FIFO has overflowed or there are more than one set of data <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>outs</em>&nbsp;</td><td>user supplied string to return parsed results into. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true if successfully parsed; false if contents not parseable (more than one set, overflow, etc) </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00393">393</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_mem_format_8cpp-source.html#l00407">LatticeSemi_PCIe::MemFormat::formatBlockOfWords()</a>, <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>, and <a class="el" href="_s_f_i_f_8cpp-source.html#l00030">TIMESTAMP</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="LatticeSemi_PCIe::SFIF::getSFIFRegs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int SFIF::getSFIFRegs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">long long *&nbsp;</td>
          <td class="mdname" nowrap> <em>elements</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the various counter values in the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> in 64 bit integer format. This is primarily used by the GUI (Java) for computing thruputs and Java doesn't support 32bit unsigned, so values need to be 64 bit. <dl compact><dt><b>Returns:</b></dt><dd>number of elements written into the array </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00269">269</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="LatticeSemi_PCIe::SFIF::setupSFIF"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SFIF::setupSFIF           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>runMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>trafficMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>cycles</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>ICG</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>rdTLPSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>wrTLPSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>numRdTLPs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>numWrTLPs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>pktRdRatio</em> = <code>4</code>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>uint32_t&nbsp;</td>
          <td class="mdname" nowrap> <em>pktWrRatio</em> = <code>1</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Setup the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> to operate in a certain mode. Operating mode is controlled by runMode and trafficMode parameters. <p>
Operating mode can be either THRUPUT_MODE, READ_CYC_MODE or WRITE_CYC_MODE. THRUPUT_MODE runs continuously. Cycle mode only runs for the given number of cycles. <p>
trafficMode defines the types of TLPs. There are 4 types that can be created and placed in the TX FIFO. <ul>
<li>
MRD_TLPS - MRd requests with payload Pattern = &lt;pkt#[31:24]&gt;&lt;tag[24:16]&gt;&lt;word#[15:8][7:8]&gt; </li>
<li>
MWR_TLPS _ MWr with a pre-defined payload pattern=&lt;pkt#[31:24]&gt;&lt;RunTimes[23:16]&gt;&lt;word#[15:0]&gt; </li>
<li>
MRD_MWR_TLPS - Read and Write TLPs based on ratio </li>
<li>
MRD_MWR_CTRL_TLPS - same as above (Ctrl not implemented yet) </li>
</ul>
<p>
This function does not start the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a>. That must be done with a call to <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a10">startSFIF()</a>. The operations performed are: <ol>
<li>
reset the controls and FIFOs </li>
<li>
clear Sys Common Buf, fill with pattern if RD mode </li>
<li>
Setup ICG and other simple params </li>
<li>
determine Xfer type </li>
<li>
load the Tx FIFO with specifc traffic pattern </li>
</ol>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>runMode</em>&nbsp;</td><td>continuous or cycle mode </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>trafficMode</em>&nbsp;</td><td>RDs, WRs or both </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cycles</em>&nbsp;</td><td>number of times to replay TX FIFO </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ICG</em>&nbsp;</td><td>number of 125MHz clks to wait between cycles, before resending TX FIFO </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rdTLPSize</em>&nbsp;</td><td>read request size in bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wrTLPSize</em>&nbsp;</td><td>payload size in bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numRdTLPs</em>&nbsp;</td><td>number of Rd TLPs per cycle to place in TX FIFO </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numWrTLPs</em>&nbsp;</td><td>number of Wr TLPs per cycle to place in TX FIFO </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00628">628</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00177">LatticeSemi_PCIe::Device::write32()</a>, and <a class="el" href="_l_s_c_p_c_ie2___i_f_8cpp-source.html#l00093">LatticeSemi_PCIe::LSCPCIe2_IF::writeSysDmaBuf()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="LatticeSemi_PCIe::SFIF::showRegs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void SFIF::showRegs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Print the values of the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> registers to STDOUT. Use to get a quick dump of the current state of all <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> registers. 
<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00145">145</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="LatticeSemi_PCIe::SFIF::startSFIF"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SFIF::startSFIF           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>loop</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Start the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> operating by setting the Run bit. All other bits are left alone. Its assumed they have been properly set up in the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html#a8">setupSFIF()</a> routine. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>loop</em>&nbsp;</td><td>if true then enable continuous looping, else play Tx FIFO once and stop </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true if successfuly started </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00172">172</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>, and <a class="el" href="_device_8cpp-source.html#l00177">LatticeSemi_PCIe::Device::write32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="LatticeSemi_PCIe::SFIF::stopSFIF"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SFIF::stopSFIF           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Stop the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> operating by clearing the Run bit. All other bits are left alone so the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> can be re-started by setting the run bit. The call waits 1 msec to ensure the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> is stopped (a cycle completes) before returning to ensure all counters have settled. <dl compact><dt><b>Returns:</b></dt><dd>true if successfuly stopped </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00201">201</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.
<p>
References <a class="el" href="_device_8cpp-source.html#l00159">LatticeSemi_PCIe::Device::read32()</a>, and <a class="el" href="_device_8cpp-source.html#l00177">LatticeSemi_PCIe::Device::write32()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="LatticeSemi_PCIe::SFIF::verifyMWrXfer"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool SFIF::verifyMWrXfer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">uint32_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>pUserBuf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em> = <code>0</code></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compare a local saved copy of the transmit FIFO payload to received values. The <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> LoadMWr saves the payload contents in TxSaveBuf[]. Only the first cycle is saved (i.e. only a cycle is loaded into the Tx FIFO) Notes on Cycles: The TLPs sent are only relavant as a single cycle. Repeating Cycles will write to the same memory addresses that the first one did, so the transfer results of subsequent cycles are indistinguishable from the first cycle. So only need to check one cycles worth. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pUserBuf</em>&nbsp;</td><td>pointer to callers data that is the end result of the transfer from the <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> into PC system memory. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>number of bytes to compare. If 0, then use what <a class="el" href="class_lattice_semi___p_c_ie_1_1_s_f_i_f.html">SFIF</a> recorded as xfer size.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true if matches </dd></dl>

<p>
Definition at line <a class="el" href="_s_f_i_f_8cpp-source.html#l00353">353</a> of file <a class="el" href="_s_f_i_f_8cpp-source.html">SFIF.cpp</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jul 16 12:05:27 2008 for Lattice PCIe API Manual by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
