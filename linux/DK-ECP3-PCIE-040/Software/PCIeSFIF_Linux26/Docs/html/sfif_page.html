<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Lattice PCIe Thruput Demo: PCIe SFIF Menu Program</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
SFIF_menu is a console app in <b><a class="el" href="_s_f_i_f__menu_8cpp.html">SFIF_menu.cpp</a></b> that allows various TLPs types to be sent from the PCIe Eval board to the Root Complex. The SFIF IP core is used to test the PCIe link. The SFIF IP reads TLPs from a Tx FIFO. These TLPs are loaded by software (this program) based on user input. Various types of TLPs can be sent (MRd, MWr). The following diagram illustrates the components of the SFIF IP module. The main points are the Control registers that allow loading the Transmit FIFO and reading the Receive FIFO and controlling operation, and the counter registers that are used for tracking the activity and computing the thruput. The SFIF is accessed and controlled via the Wishbone slave interface. The SFIF operates in 2 basic modes: (1) cycle mode (2) thruput mode. In cycle mode the SFIF plays out the TX FIFO the programmed number of cycles. In thruput mode the SFIF just keep playing out the TX FIFO over and over until its stopped. Counters are 32 bits, and will wrap (based on the 125 MHz PCIe clk) in 30 seconds, so don't run longer than 30 seconds or the results will be unusable.<p>
<div class="fragment"><pre class="fragment">
                   -----+--------- Wishbone Bus
	   SFIF         |
	  --------------|----------------
	  |      |     WBs     |        |
	  |      -------+-------        |
	  |             |               |
	  |       ------+-------        |
	  |       |  Ctrl &amp;    |        | 
	  |    +--|  Cntrs     +---+    | 
	  |    |  --------------   |    |
	  | ---+----           ----+--- |
	  | |  TX  |           |  Rx  | |
	  | | FIFO |           | FIFO | |
	  | --------           -------- |
	  -----|------------------/|\----
               |                   |
              \|/                  |
             MWr/MRd              CplD  
                   PCIe IP core
 </pre></div><p>
The SFIF hardware is controlled through the SFIF class that is part of the PCIeAPI_Lib. The SFIF class provides methods to load TLPs into the TX FIFO, start the SFIF and read back the resulting counters. This program does not directly access the SFIF registers. See the SFIF class for details on internal operation. Some registers that are used for computing resulting transfer thruputs are:<p>
<b>SFIF Counter Registers</b> <ul>
<li>
ElapsedTime - total clks between while SFIF is enabled </li>
<li>
TxTLPCnt - number of TLPs sent from the TX FIFO while the SFIF is enabled </li>
<li>
RxTLPCnt - number of CplDs recvd, counts can occur well after SFIF is enabled </li>
<li>
WrWaitTime - number of clk cycles when a MWr TLP needed to be sent but no credits available </li>
<li>
LastCplDTime - time stamp (clk cycles since SFIF started) of the last CplD recvd, used for MRd thruput calculations </li>
<li>
RdWaitTime - number of clk cycles when a MRd TLP needed to be sent but no credits available </li>
</ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jul 16 12:05:29 2008 for Lattice PCIe Thruput Demo by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
