<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Lattice PCIe Thruput Demo: SFIF_menu.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000002.html">SFIF_menu</a></div>
<h1>SFIF_menu.cpp File Reference</h1><code>#include &lt;cstdlib&gt;</code><br>
<code>#include &lt;iostream&gt;</code><br>
<code>#include &lt;string&gt;</code><br>
<code>#include &lt;exception&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include "PCIeAPI.h"</code><br>
<code>#include "LSCPCIe2_IF.h"</code><br>
<code>#include "GPIO.h"</code><br>
<code>#include "SFIF.h"</code><br>
<code>#include "MiscUtils.h"</code><br>
<code>#include "MemFormat.h"</code><br>
<code>#include "../MemMap.h"</code><br>

<p>
<a href="_s_f_i_f__menu_8cpp-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a5">writeTlpMenu</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a6">readTlpMenu</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a7">thruputTests</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a8">changeConfigSettings</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a9">GPIOTest</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a10">showSFIFCounters</a> (SFIF::SFIFCntrs_t &amp;sfifCnts)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_s_f_i_f__menu_8cpp.html#a11">main</a> (int argc, char **argv, char **env)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a0" doxytag="SFIF_menu.cpp::pDrvr"></a>
LSCPCIe2_IF *&nbsp;</td><td class="memItemRight" valign="bottom"><b>pDrvr</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a1" doxytag="SFIF_menu.cpp::pSFIF"></a>
SFIF *&nbsp;</td><td class="memItemRight" valign="bottom"><b>pSFIF</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a2" doxytag="SFIF_menu.cpp::pGPIO"></a>
GPIO *&nbsp;</td><td class="memItemRight" valign="bottom"><b>pGPIO</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a3" doxytag="SFIF_menu.cpp::WriteDmaBuf"></a>
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>WriteDmaBuf</b> [FIFO_SIZE/4]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a4" doxytag="SFIF_menu.cpp::ReadDmaBuf"></a>
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><b>ReadDmaBuf</b> [FIFO_SIZE/4]</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
Definition in file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.<hr><h2>Function Documentation</h2>
<a class="anchor" name="a8" doxytag="SFIF_menu.cpp::changeConfigSettings"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void changeConfigSettings           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Change global configuration parameters. Parameters that are used in the TLP headers. 
<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00517">517</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
Referenced by <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00155">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="SFIF_menu.cpp::GPIOTest"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void GPIOTest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Run some test to verify access to the GPIO module. This proves that PCIe control plane type access is working. 
<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00468">468</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
Referenced by <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00155">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="SFIF_menu.cpp::main"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>env</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
SFIF Menu Console App Entry Point. Open access to an eval board that has the PCIe Thruput demo IP loaded into the FPGA. Then create instances of the SFIF and GPIO devices to control the demo hardware. Then display menu options to let the user exercise various TLP transfers and compute the resulting throughput. <p>
Requires the standard environment variables to be defined to identify which eval board to connect to and operate on. 
<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00155">155</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
References <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00517">changeConfigSettings()</a>, <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00468">GPIOTest()</a>, <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00739">readTlpMenu()</a>, <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00862">thruputTests()</a>, and <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00595">writeTlpMenu()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="SFIF_menu.cpp::readTlpMenu"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void readTlpMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate MRd TLPs and load into TX FIFO and send to PC. The user can select the payload size and the number of packets to send per cycle. The cycle parameter allows the TX FIFO contents to be re-played out a number of times. The ICG (Inter Cycle Gap) is used to insert a delay of that many 125 MHz clk periods between cycles. The received Completions with Data are captured in the RX FIFO and processed to verify all read requests were satisfied. 
<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00739">739</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
References <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00576">showSFIFCounters()</a>.
<p>
Referenced by <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00155">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="SFIF_menu.cpp::showSFIFCounters"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void showSFIFCounters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SFIF::SFIFCntrs_t &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>sfifCnts</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Display the SFIF TLP counter registers. Usually called after a run to see what has transpired - number of TLPs sent, number CplD recvd, elapsed time, etc. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sfifCnts</em>&nbsp;</td><td>the SFIF structure defining the various register fields </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00576">576</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
Referenced by <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00739">readTlpMenu()</a>, <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00862">thruputTests()</a>, and <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00595">writeTlpMenu()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="SFIF_menu.cpp::thruputTests"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void thruputTests           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Throughput Tests. Run a write Run a Read Run a Read &amp; Write Run a Read &amp; Write and system access 
<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00862">862</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
References <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00576">showSFIFCounters()</a>.
<p>
Referenced by <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00155">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="SFIF_menu.cpp::writeTlpMenu"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void writeTlpMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate MWr TLPs and load into TX FIFO and send to PC. The user can select the payload size and the number of packets to send per cycle. The cycle parameter allows the TX FIFO contents to be re-played out a number of times. The ICG (Inter Cycle Gap) is used to insert a delay of that many 125 MHz clk periods between cycles. 
<p>
Definition at line <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00595">595</a> of file <a class="el" href="_s_f_i_f__menu_8cpp-source.html">SFIF_menu.cpp</a>.
<p>
References <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00576">showSFIFCounters()</a>.
<p>
Referenced by <a class="el" href="_s_f_i_f__menu_8cpp-source.html#l00155">main()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Jul 16 12:05:29 2008 for Lattice PCIe Thruput Demo by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
