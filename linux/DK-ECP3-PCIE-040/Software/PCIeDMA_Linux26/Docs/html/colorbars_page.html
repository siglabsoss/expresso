<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Lattice PCIe DMA Demos: PCIe DMA ColorBar Demo</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
The ColorBars demo (see <a class="el" href="_color_bars_8cpp.html">ColorBars.cpp</a>) demonstrates the Lattice PCIe IP core and the SGDMA IP core operating on a PCIe Eval Board. It transfers image data from the Eval Board to PC memory and software then displays it on the screen. The image source is a block of IP operating as a FIFO. The IP tracks how many reads have been requested, and after 8 complete rows have been read, it changes the color data provided with the next 8 rows.<p>
<div class="fragment"><pre class="fragment">
  
    |------------------|
    | Image Data       |
    | Generator        |
    | (ColorBars)      |
    |__________________|
             |
             V
     |-----------------|
     | SGDMA IP Core   |&lt;-------------+
     |_________________|              |
             |                        |
             V                        |
     |-----------------|              |
     |  PCIe IP Core   |              |
     |_________________|         |----------------|
             |                   | Driver         |
             V                   |________________|
      |----------------|              ^
      | Image Buffer   |&lt;--+          |
      |________________|   |     |----------------|
             |             |_____| Application    |
             V                   |  (this file)   |
      |----------------|         |________________|
      | OpenGL Window  |
      |________________|
  
   </pre></div><p>
The image is displayed using OpenGL calls. The display rate is therefore also dependent on the OpenGL library and graphics subsystem hardware. Displaying an image is a quick way to illustrate that data has been moved. It would not be practical to display 1MB to the screen in a text dump, or save it to a file. An image provides a quick, visual way to observe a large transfer of data, and it can run continuously. <p>
The image data is 1MB in size. Each DMA Read request is 1MB in size. After the hardware has transferred the pixel data, the API call returns and the software displays the image. This loop is repeated over and over. The data rate (frame rate) is displayed in the window title bar. The frame rate is roughly the throughput rate in MB/sec. (each frame = 1 MB). Frame rate is governed by the video refresh rate. Most video systems will not draw frames into video memory faster than the frame rate (waste of operations). <p>
Running: <ul>
<li>
[Esc] - terminates program and closes the window </li>
<li>
[F1] - just draw blank image buffer (don't generate data) - fastest rate </li>
<li>
[F2] - generate color bar data via software, should be slowest data rate </li>
<li>
[F3] - get image data from eval board via DMA transfer </li>
<li>
[F4] - Draw a frame each second (slowly) so it can be viewed and the changes seen </li>
<li>
[Space] - pause/resume image transfer </li>
</ul>
<p>
The main structure of this application is based on OpenGL and glut (GL Utilities Libraries). Printf's go to a console. The graphics window needs to have focus to accept commands. <hr size="1"><address style="align: right;"><small>Generated on Wed Jul 16 12:05:28 2008 for Lattice PCIe DMA Demos by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
